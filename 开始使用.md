# 🎉 欢迎使用 AutomationAPI！

恭喜！AutomationAPI项目已成功创建，所有功能已准备就绪。

## ✅ 项目状态

```
✅ Django项目已创建
✅ 数据库已初始化
✅ 14个API端点已配置
✅ Admin后台已配置
✅ 所有测试通过（13/13）
✅ 文档已完成（7份）
```

## 🚀 立即开始

### 1. 启动项目（仅需一条命令）

```bash
cd /Users/yzk/MyProjects/AutomationAPI
./start.sh
```

### 2. 访问系统

启动后，访问以下地址：

- 🏠 **主页**: http://127.0.0.1:8000/
  - 查看API端点列表和系统信息
  
- 🔐 **Admin后台**: http://127.0.0.1:8000/admin/
  - 管理Token、端点、查看日志
  - 配置Teams消息和邮件模板
  
- 📡 **API根路径**: http://127.0.0.1:8000/api/
  - REST API接口入口

### 3. 配置微软应用（必需）

在使用之前，需要在Azure AD中注册应用：

**快速步骤：**

1. 访问 [Azure Portal](https://portal.azure.com/)
2. **Azure Active Directory** → **应用注册** → **新注册**
3. 创建后获取：
   - 应用程序(客户端)ID
   - 目录(租户)ID
   - 客户端密码
4. 添加权限并**授予管理员同意**

**详细指南**: 查看 `QUICKSTART.md` 第二步

### 4. 添加Token

1. 登录Admin后台: http://127.0.0.1:8000/admin/
2. 点击 **API Tokens** → **添加**
3. 填写Azure应用的凭证
4. 保存

### 5. 测试API

#### 方式1：使用curl

```bash
# 发送Teams消息
curl -X POST http://127.0.0.1:8000/api/microsoft/send_teams_message/ \
  -u admin:yourpassword \
  -H "Content-Type: application/json" \
  -d '{
    "message_type": "channel",
    "team_id": "YOUR-TEAM-ID",
    "channel_id": "YOUR-CHANNEL-ID",
    "message": "Hello! 🚀"
  }'
```

#### 方式2：使用Postman

导入 `postman_collection.json` 文件，包含所有API的示例请求。

#### 方式3：使用Python

```python
import requests

BASE_URL = "http://127.0.0.1:8000/api"
AUTH = ("admin", "yourpassword")

# 发送邮件
response = requests.post(
    f"{BASE_URL}/microsoft/send_email/",
    json={
        "to_recipients": ["user@example.com"],
        "subject": "测试",
        "body": "<h1>成功！</h1>"
    },
    auth=AUTH
)
print(response.json())
```

## 📚 文档导航

| 文档 | 说明 | 适合人群 |
|------|------|----------|
| **QUICKSTART.md** | 5分钟快速开始 | ⭐ 新用户必读 |
| **README.md** | 完整项目文档 | 所有用户 |
| **API_EXAMPLES.md** | API使用示例 | 开发者 |
| **DEPLOYMENT.md** | 生产环境部署 | 运维人员 |
| **PROJECT_SUMMARY.md** | 技术架构总结 | 技术人员 |
| **项目交付清单.md** | 项目交付内容 | 项目经理 |
| **项目结构.txt** | 项目结构说明 | 所有用户 |

## 🎯 核心功能

### 1. Token管理
- ✅ 在Admin后台统一管理微软应用凭证
- ✅ 自动Token刷新
- ✅ 支持多个Token

### 2. 微软服务集成

**Microsoft Teams**
- 发送频道消息
- 发送聊天消息
- 列出团队

**Outlook邮件**
- 发送HTML/文本邮件
- 获取邮件列表
- 支持抄送

**SharePoint**
- 访问站点和列表
- 上传文件
- 管理文档库

### 3. 使用监控
- ✅ 详细的API调用日志
- ✅ 性能统计分析
- ✅ 错误追踪

### 4. 模板管理
- ✅ Teams消息模板
- ✅ 邮件模板
- ✅ 变量替换支持

## 💡 使用场景

### 场景1：自动化通知
```
需求：每天自动向Teams频道发送报告
实现：调用 /api/microsoft/send_teams_message/
```

### 场景2：批量邮件发送
```
需求：向多个用户发送自定义邮件
实现：调用 /api/microsoft/send_email/
```

### 场景3：SharePoint数据同步
```
需求：定期同步SharePoint列表数据
实现：调用 /api/microsoft/sharepoint_operation/
```

## 🔧 常用命令

```bash
# 启动服务
./start.sh
# 或
python manage.py runserver

# 创建管理员
python manage.py createsuperuser

# 运行测试
python manage.py test

# 查看日志（在Admin后台）
http://127.0.0.1:8000/admin/microsoft_api/apiusagelog/

# 初始化端点
python manage.py init_endpoints
```

## ❓ 常见问题

### Q: 如何获取Teams的team_id和channel_id？

**A**: 
```bash
# 方式1：使用API
curl -u admin:password http://127.0.0.1:8000/api/microsoft/list_teams/

# 方式2：从Teams URL获取
在Teams中打开频道，URL中包含这些ID
```

### Q: Token显示无效怎么办？

**A**: Token首次创建时是无效的，第一次调用API会自动获取并缓存访问令牌。

### Q: API调用失败？

**A**: 
1. 检查Azure应用权限
2. 确认已授予管理员同意
3. 查看Admin后台的使用日志了解详细错误

### Q: 如何在生产环境部署？

**A**: 查看 `DEPLOYMENT.md` 文档，有完整的部署指南。

## 📊 系统监控

### Admin后台功能

1. **API Tokens** - 管理认证凭证
2. **API端点** - 查看和配置端点
3. **API使用日志** - 详细的调用记录
   - 按状态筛选
   - 按时间筛选
   - 查看请求/响应详情
4. **Teams消息模板** - 管理可复用模板
5. **邮件模板** - 管理邮件模板

### 统计信息

```bash
# 查看端点统计
curl -u admin:password http://127.0.0.1:8000/api/endpoints/statistics/

# 查看使用统计
curl -u admin:password http://127.0.0.1:8000/api/logs/statistics/?days=30
```

## 🎓 学习路径

### 新手（Day 1）
1. ✅ 阅读本文档
2. ✅ 启动项目并访问Admin后台
3. ✅ 配置Azure应用
4. ✅ 添加第一个Token
5. ✅ 测试发送Teams消息或邮件

### 进阶（Day 2-3）
1. ✅ 阅读 API_EXAMPLES.md
2. ✅ 使用Postman测试所有API
3. ✅ 创建消息和邮件模板
4. ✅ 集成到自己的Python脚本

### 高级（Week 1+）
1. ✅ 阅读 PROJECT_SUMMARY.md 了解架构
2. ✅ 扩展自定义API端点
3. ✅ 部署到生产环境
4. ✅ 集成到现有系统

## 🌟 下一步建议

### 立即可做
- [ ] 启动项目并登录Admin后台
- [ ] 配置第一个Token
- [ ] 发送第一条测试消息
- [ ] 查看使用日志

### 本周完成
- [ ] 创建消息模板
- [ ] 测试所有API功能
- [ ] 编写集成脚本
- [ ] 配置定时任务

### 未来规划
- [ ] 添加更多微软服务
- [ ] 开发前端界面
- [ ] 集成到工作流
- [ ] 部署到生产环境

## 📞 获取帮助

### 文档资源
- 📖 完整文档: `README.md`
- 🚀 快速开始: `QUICKSTART.md`
- 💻 API示例: `API_EXAMPLES.md`
- 🔧 部署指南: `DEPLOYMENT.md`

### 故障排查
1. 查看Admin后台的使用日志
2. 运行 `python manage.py check`
3. 查看错误消息
4. 参考文档中的常见问题

## 🎊 开始你的自动化之旅！

AutomationAPI已经准备好为你服务了！

**建议的第一步：**
```bash
# 1. 启动项目
./start.sh

# 2. 在浏览器中打开
# http://127.0.0.1:8000/admin/

# 3. 开始配置！
```

---

**项目状态**: ✅ 完全就绪
**版本**: 1.0.0
**最后更新**: 2024年12月1日

祝使用愉快！如有问题，请查看相关文档。🚀

